<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/GridapOffshore.jl/libs/katex/katex.min.css"> <link rel=stylesheet  href="/GridapOffshore.jl/libs/highlight/github.min.css"> <link href="/GridapOffshore.jl/css/franklin.css" rel=stylesheet > <link href="/GridapOffshore.jl/css/vela.css" rel=stylesheet > <script src="/GridapOffshore.jl/libs/vela/jquery.min.js"></script> <link rel=icon  href="/GridapOffshore.jl/assets/favicon.png"> <title>Franklin Example | Vela</title> <div class="main-nav slideout-menu slideout-menu-left" id=menu > <div class=flex-container > <span class=sidebar-brand > <h3 style='font-size: 25px'>Gridap Offshore</h3> </span> </div> <nav class=sidebar-nav > <ul class=metismenu  id=metismenu  > <li><a href="/GridapOffshore.jl/index.html">Home</a> <li><a href="" class=has-arrow >Theory</a> <ul> <li><a href="/GridapOffshore.jl/Theory/tutorial_1/intro_FE_1D">1. Solving PDEs with Gridap</a> </ul> <li><a href="" class=has-arrow >MSc thesis</a> <ul> <li><a href="" class=has-arrow >Floating structures</a> <ul> <li><a href="/GridapOffshore.jl/MSc_thesis/Floating/2021_S_van_Hoof/VFFS">S. van Hoof, 2021</a> <li><a href="/GridapOffshore.jl/MSc_thesis/Floating/2021_D_Regout/VLFS">D. Regout, 2021</a> </ul> <li><a href="" class=has-arrow >Porous media</a> <ul> <li><a href="/GridapOffshore.jl/MSc_thesis/Porous/2022_J_Ruesen/porous">J. Ruesen, 2022</a> </ul> </ul> </ul> </nav> </div> <main id=panel  class="slidout-panel slideout-panel-left"> <div class="toggle-button hamburger hamburger--spin"> <div class=hamburger-box > <div class=hamburger-inner ></div> </div> </div> <h1 class="page title">Solving PDEs with Gridap.jl</h1> <hr> <div class=franklin-content ><p>In this tutorial we will learn how to solve PDEs using the Finite Element method by using <a href="https://github.com/gridap/Gridap.jl"><strong>Gridap.jl</strong></a>.</p> <p><em>Gridap.jl</em> is a multi-purpose FE library writen in pure <a href="https://julialang.org/"><em>Julia language</em></a>. The <em>Gridap.jl</em> library is a very complete that supports linear and nonlinear PDE systems for scalar and vector fields, single and multi-field problems, conforming and nonconforming FE discretizations, on structured and unstructured meshes of simplices and n-cubes. One of the main advantages of <em>Gridap.jl</em> is that it has a very expressive API allowing one to solve complex PDEs with very few lines of code, as we will see in what follows.</p> <h1 id=problem_setting ><a href="#problem_setting" class=header-anchor >Problem setting</a></h1> <figure style="text-align:center;"> <img src="/GridapOffshore.jl/Theory/tutorial_1/img/barDefinition-1.png" style="padding:0; width:80%;" alt=" One dimensional rod with distributed load"/> <figcaption> One dimensional rod with distributed load</figcaption> </figure> <p>Here we consider the simple 1-dimensional rod equation. From the strong form we can derive the <em>weak form</em> of the problem:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>L</mi></msubsup><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>w</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mi>E</mi><mi>A</mi><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>u</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mi>d</mi><mi>x</mi><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>L</mi></msubsup><mi>w</mi><mi>f</mi><mtext> </mtext><mi>d</mi><mi>x</mi><mo>+</mo><mi>w</mi><mo stretchy=false >(</mo><mi>L</mi><mo stretchy=false >)</mo><mi>F</mi><mo separator=true >,</mo><mspace width=1em /><mi mathvariant=normal >∀</mi><mspace width=1em /><mi>w</mi></mrow><annotation encoding="application/x-tex"> \int_{0}^{L} \frac{\partial w}{\partial x}EA \frac{\partial u}{\partial x}\,dx = \int_0^Lwf\,dx + w(L)F,\quad\forall\quad w </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.503181em;vertical-align:-0.9119499999999999em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.591231em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">A</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">u</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.503181em;vertical-align:-0.9119499999999999em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.591231em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mopen >(</span><span class="mord mathnormal">L</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >∀</span><span class=mspace  style="margin-right:1em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span></span> <h1 id=domain_discretization ><a href="#domain_discretization" class=header-anchor >Domain discretization</a></h1> <p>The first step that we need to do is to define the discretization of our domain. Since the geometry is defined by a line, we can use the <code>CartesianDiscreteModel</code> function. This function creates a discrete model with a Cartesian grid for arbitrary topological dimensions, <em>i.e.</em> a line in 1D, a square in 2D, a cube in 3D, ... The function <code>CartesianDiscreteModel</code> requires two main arguments: <code>domain</code> and <code>partition</code>. <code>domain</code> is a tuple with inital and final coordinates of the domain in each direction, in our case <code>domain&#61;&#40;0,L&#41;</code>. <code>partition</code> is a tuple of number of cells per direction, if we solve the problem using 10 elements, we will define <code>partition&#61;&#40;10,&#41;</code>. With these two arguments we can define our discrete model <code>model</code>:</p> <pre><code class="julia hljs">L = <span class=hljs-number >3</span>
domain = (<span class=hljs-number >0</span>,L)
partition = (<span class=hljs-number >10</span>,)
model = CartesianDiscreteModel(domain,partition)</code></pre> <p>Once we have the domain discretization, we need to identify the boundaries to be able to enforce boundary conditions later on. To do that, we use the <em>labeling</em> functionality of Gridap. First, we get the default labels of the <code>model</code> using the <code>get_face_labeling</code> function. Then, we add tags for the <em>left</em> and <em>right</em> vertices of the domain, which are entities <code>1</code> and <code>2</code>, respectively, using the <code>add_tag_from_tags&#33;</code> function.</p> <pre><code class="julia hljs">labels = get_face_labeling(model)
add_tag_from_tags!(labels,<span class=hljs-string >&quot;left&quot;</span>,[<span class=hljs-number >1</span>])
add_tag_from_tags!(labels,<span class=hljs-string >&quot;right&quot;</span>,[<span class=hljs-number >2</span>])</code></pre> <p>With the discrete model defined and the boundary entities tagged, we can define the triangulations over which we will define the FE spaces and integration rules. In this case, we have an interior triangulation <code>Ω</code> and a boundary triangulation <code>Γ</code> for the right-end vertex. Note that in the 1D case, the boundary triangulation <code>Γ</code> is just a point, but since Gridap is implemented for arbitrary dimensions, we still define it as a triangulation.</p> <pre><code class="julia hljs">Ω = Triangulation(model)
Γ = Boundary(Ω,tags=<span class=hljs-string >&quot;right&quot;</span>)</code></pre> <h1 id=finite_element_spaces ><a href="#finite_element_spaces" class=header-anchor >Finite Element spaces</a></h1> <p>One of the nice features of Gridap is the versatility in the definition of Finite Element sapces. That is, it allows to define different reference Finite Elements with different types of shape functions and different orders. Here we will use <em>linear Lagrangian</em> Finite Elements, using the <code>ReferenceFE</code> function with the following arguments: <code>lagrangian</code> &#40;type of elements&#41;, <code>Float64</code> &#40;type of unknown variable&#41; and <code>1</code> &#40;polynomial order&#41;.</p> <pre><code class="julia hljs">reffe = ReferenceFE(lagrangian,<span class=hljs-built_in >Float64</span>,<span class=hljs-number >1</span>)</code></pre>
<p>With the reference FE defined, we can construct the FE space for the test functions <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">w_h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#40;test FE space&#41;. A test FE space is defined by the type of reference Finite Element &#40;<code>reffe</code>&#41;, the triangulation over which the space is defined &#40;<code>Ω</code>&#41; and the Dirichlet boundary tags &#40;<code>&quot;left&quot;</code>&#41;.</p>
<pre><code class="julia hljs">Vₕ = TestFESpace(Ω,reffe,dirichlet_tags=<span class=hljs-string >&quot;left&quot;</span>)</code></pre>
<p>The FE space for the unknowns <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">u_h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#40;trial FE space&#41; is constructed from the test FE space and specifying the value of the Dirichlet boundary condition, in that case <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mo>=</mo><mn>0.0</mn></mrow><annotation encoding="application/x-tex">u=0.0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0.0</span></span></span></span> on <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x=0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>.</p>
<pre><code class="julia hljs">Uₕ = TrialFESpace(V,<span class=hljs-number >0.0</span>)</code></pre>
<h1 id=discrete_form ><a href="#discrete_form" class=header-anchor >Discrete form</a></h1>
<p>The discrete form of the problem reads: <em>find <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>h</mi></msub><mo>∈</mo><msub><mi mathvariant=script >U</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">u_h\in\mathcal{U}_h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.6891em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.09931em;">U</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09931em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> such that</em></p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mi>L</mi></msubsup><mfrac><mrow><mi mathvariant=normal >∂</mi><msub><mi>w</mi><mi>h</mi></msub></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mi>E</mi><mi>A</mi><mfrac><mrow><mi mathvariant=normal >∂</mi><msub><mi>u</mi><mi>h</mi></msub></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mi>d</mi><mi mathvariant=normal >Ω</mi><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>L</mi></msubsup><msub><mi>w</mi><mi>h</mi></msub><mi>f</mi><mtext> </mtext><mi>d</mi><mi mathvariant=normal >Ω</mi><mo>+</mo><msub><mi>w</mi><mi>h</mi></msub><mo stretchy=false >(</mo><mi>L</mi><mo stretchy=false >)</mo><mi>F</mi><mo separator=true >,</mo><mspace width=1em /><mi mathvariant=normal >∀</mi><mspace width=1em /><msub><mi>w</mi><mi>h</mi></msub><mo>∈</mo><msub><mi mathvariant=script >V</mi><mi>h</mi></msub><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> 
\int_{0}^{L} \frac{\partial w_h}{\partial x}EA \frac{\partial u_h}{\partial x}\,d\Omega = \int_0^Lw_hf\,d\Omega + w_h(L)F,\quad\forall\quad w_h\in\mathcal{V}_h.
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.503181em;vertical-align:-0.9119499999999999em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.591231em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">A</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">u</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class=mord >Ω</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.503181em;vertical-align:-0.9119499999999999em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.591231em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class=mord >Ω</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal">L</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=mpunct >,</span><span class=mspace  style="margin-right:1em;"></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >∀</span><span class=mspace  style="margin-right:1em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.08222em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >.</span></span></span></span></span>
<p>We have seen how to define the FE spaces <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=script >V</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{V}_h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.08222em;">V</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.08222em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant=script >U</mi><mi>h</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{U}_h</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathcal" style="margin-right:0.09931em;">U</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.09931em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>. The only missing piece now is the definition of the <em>numerical integration</em> rules. We can define an integration quadrature defining the Lebesgue <code>Measure</code> in a given <em>domain</em> with a prescribed <em>degree</em> that can be exactly integrated. In this case we will have two integration measures, <code>dΩ</code> for the interior integrals and <code>dΓ</code> for the boundary evaluation, both using <code>dregree&#61;2</code>:</p>
<pre><code class="julia hljs">dΩ = Measure(Ω,<span class=hljs-number >2</span>)
dΓ = Measure(Γ,<span class=hljs-number >2</span>)</code></pre>
<p>Before defining the discrete form we set some material properties.</p>
<pre><code class="julia hljs">EA = <span class=hljs-number >1.0e3</span>
F = <span class=hljs-number >10</span>
q = -<span class=hljs-number >10</span></code></pre>
<p>Now we are ready to define the discrete form equivalent to &#123;eq&#125;<code>1d_discreteform_gridap</code>. To this end we define a bilinear operator <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy=false >(</mo><mi>u</mi><mo separator=true >,</mo><mi>w</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">a(u,w)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mopen >(</span><span class="mord mathnormal">u</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mclose >)</span></span></span></span> for the left-hand side of the equation &#123;eq&#125;<code>1d_discreteform_gridap</code> and a linear operator independent of the solution <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo stretchy=false >(</mo><mi>w</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">l(w)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mclose >)</span></span></span></span> equivalent to the right-hand side of equation &#123;eq&#125;<code>1d_discreteform_gridap</code>.</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>a</mi><mo stretchy=false >(</mo><mi>u</mi><mo separator=true >,</mo><mi>w</mi><mo stretchy=false >)</mo><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>L</mi></msubsup><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>w</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mi>E</mi><mi>A</mi><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>u</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mi>d</mi><mi mathvariant=normal >Ω</mi><mo separator=true >,</mo><mspace linebreak=newline ></mspace><mi>l</mi><mo stretchy=false >(</mo><mi>w</mi><mo stretchy=false >)</mo><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>L</mi></msubsup><mi>w</mi><mi>f</mi><mtext> </mtext><mi>d</mi><mi mathvariant=normal >Ω</mi><mo>+</mo><mi>w</mi><mo stretchy=false >(</mo><mi>L</mi><mo stretchy=false >)</mo><mi>F</mi><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> 
a(u,w) = \int_{0}^{L} \frac{\partial w}{\partial x}EA \frac{\partial u}{\partial x}\,d\Omega, \\
l(w) = \int_0^Lwf\,d\Omega + w(L)F.
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mopen >(</span><span class="mord mathnormal">u</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.503181em;vertical-align:-0.9119499999999999em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.591231em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">A</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">u</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class=mord >Ω</span><span class=mpunct >,</span></span><span class="mspace newline"></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.503181em;vertical-align:-0.9119499999999999em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.591231em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.8129000000000004em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class=mord >Ω</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class=mopen >(</span><span class="mord mathnormal">L</span><span class=mclose >)</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=mord >.</span></span></span></span></span>
<pre><code class="julia hljs">a(u,w) = ∫(EA*(∇(w)⋅∇(u)))dΩ
  l(w) = ∫(q*w)dΩ + ∫(F*w)dΓ</code></pre>
<p>With the bilinear and linear forms <code>a</code> and <code>l</code> defined, we can construct a Finite Element operator that given these forms and the Finite Element spaces <code>Uₕ</code> and <code>Vₕ</code> constructs the discrete systemof  equations </p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mrow><mi mathvariant=bold >K</mi><mi mathvariant=bold >u</mi></mrow><mo>=</mo><mi mathvariant=bold >f</mi><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex">\mathbf{Ku} = \mathbf{f}.</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68611em;vertical-align:0em;"></span><span class=mord ><span class="mord mathbf">Ku</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathbf" style="margin-right:0.10903em;">f</span><span class=mord >.</span></span></span></span></span>
<p>Since the problem is linear and static, we can use the function <code>AffineFEOperator</code>. We recommend to check the <a href="https://gridap.github.io/Tutorials/dev/">Gridap tutorials</a> for a better understanding of the different Finite Element operators available.</p>
<pre><code class="julia hljs">op = AffineFEOperator(a,l,Uₕ,Vₕ)</code></pre>
<h1 id=solution_and_postprocessing ><a href="#solution_and_postprocessing" class=header-anchor >Solution and postprocessing</a></h1>
<p>The final step is to solve the system of equations to find the solution of the problem. For this we simply call the function <code>solve</code> with the Finite Element operator <code>op</code> as argument. Gridap uses the standard <em>Backslash</em> operator <code>\</code> by default to solve the linear system, however, we could use other type of linears solvers. We are not going to cover this feature in this tutorial.</p>
<pre><code class="julia hljs">uₕ = solve(op)</code></pre>
<p>To visualize the solution we use <a href="https://www.paraview.org/">Paraview</a>, an open-source software widely used in the scientific computing community. To write the solution in <em>VTK</em> format &#40;used by Paraview&#41;, we just need to call the <code>writevtk</code> function with arguments: the triangulation where the solution is defined &#40;<code>Ω</code>&#41;, the name of the file in a string and a dictionary with the set of solution fields &#40;<code>cellfields&#61;&#91;&quot;u&quot;&#61;&gt;uₕ&#93;</code>&#41;.</p>
<pre><code class="julia hljs">writevtk(Ω,<span class=hljs-string >&quot;solution&quot;</span>,cellfields=[<span class=hljs-string >&quot;u&quot;</span>=&gt;uₕ])</code></pre>

<figure style="text-align:center;">
<img src="/GridapOffshore.jl/Theory/tutorial_1/img/Gridap_solution.png" style="padding:0; width:120%;" alt=" Finite Element solution"/>
<figcaption> Finite Element solution</figcaption>
</figure>

<div class=page-foot >
  <div class=copyright >
    &copy; Oriol Colomés. Last modified: December 31, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
  </main> 
  <script src="/GridapOffshore.jl/libs/vela/metisMenu.min.js"></script>
  <script src="/GridapOffshore.jl/libs/vela/slideout.min.js"></script>